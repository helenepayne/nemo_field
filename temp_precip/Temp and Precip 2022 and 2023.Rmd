---
title: "Temp and Precip Plots"
author: "Helen Payne"
date: "2025-06-30"
output: html_document
---

```{r}
# Load required libraries
library(tidyverse)
library(lubridate)
library(scales)
```


2022 Temp
```{r}
# Read the CSV file
df <- read_csv("/Users/Helen/Desktop/2022-temp.csv")

# Convert from wide to long format
df_long <- df %>%
  pivot_longer(-Time, names_to = "Site", values_to = "Temperature")

# Convert Date column to Date format
df_long <- df_long %>%
  mutate(Time = as.Date(Time))


df_long$Site <- recode(df_long$Site,
                       "Angelo South Meadow Air Temp Avg degC" = "Angelo Coast",
                       "Bodega Air Temp Avg degC" = "Bodega Bay",
                       "Blue Oak Ranch Air Temp Avg degC" = "Blue Oak",
                       "Hastings Air Temp Avg degC" = "Hastings Ranch")

# Plot
p <- ggplot(df_long, aes(x = Time, y = Temperature, color = Site)) +
  geom_line() +
  geom_hline(yintercept = 10, linetype = "dashed", color = "black", linewidth = 0.5) +
  labs(title = "2022 Air Temperature by Site",
       y = "Air Temperature (째C)",
       x = "Date",
       color = NULL) +
  theme_minimal(base_size = 14) +
  theme(legend.position = "right") +  
  scale_color_manual(
    values = c("Angelo Coast" = "#E69F00", "Bodega Bay" = "#009E73", "Blue Oak" = "#56B4E9", "Hastings Ranch" = "#D55E00")
  ) +
  scale_x_date(labels = date_format("%Y-%m"), date_breaks = "1 month") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

p


ggsave("2022-temperature-by-site.jpg", plot = p, width = 10, height = 6, dpi = 1000)
```


2023 Temp
```{r}
# Read the CSV file
df <- read_csv("/Users/Helen/Desktop/2023-temp.csv")

# Convert from wide to long format
df_long <- df %>%
  pivot_longer(-Time, names_to = "Site", values_to = "Temperature")

# Convert Date column to Date format
df_long <- df_long %>%
  mutate(Time = as.Date(Time))


df_long$Site <- recode(df_long$Site,
                       "Angelo South Meadow Air Temp Avg degC" = "Angelo Coast",
                       "Bodega Air Temp Avg degC" = "Bodega Bay",
                       "Blue Oak Ranch Air Temp Avg degC" = "Blue Oak",
                       "Hastings Air Temp Avg degC" = "Hastings Ranch")

# Plot
p <- ggplot(df_long, aes(x = Time, y = Temperature, color = Site)) +
  geom_line() +
  geom_hline(yintercept = 10, linetype = "dashed", color = "black", linewidth = .5) +
  labs(title = "2023 Air Temperature by Site",
       y = "Air Temperature (째C)",
       x = "Date",
       color = NULL) +
  theme_minimal(base_size = 14) +
  theme(legend.position = "right") +  
  scale_color_manual(
    values = c("Angelo Coast" = "#E69F00", "Bodega Bay" = "#009E73", "Blue Oak" = "#56B4E9", "Hastings Ranch" = "#D55E00")
  ) +
  scale_x_date(labels = date_format("%Y-%m"), date_breaks = "1 month") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

p


ggsave("2023-temperature-by-site.jpg", plot = p, width = 10, height = 6, dpi = 1000)
```

2022 Percip
```{r}
# Read the CSV file
df <- read_csv("/Users/Helen/Desktop/2022-rainfall.csv")

# Convert from wide to long format
df_long <- df %>%
  pivot_longer(-Time, names_to = "Site", values_to = "Temperature")

# Convert Date column to Date format
df_long <- df_long %>%
  mutate(Time = as.Date(Time))


df_long$Site <- recode(df_long$Site,
                       "Angelo South Meadow Rainfall Cumulative mm" = "Angelo Coast",
                       "Bodega Rainfall Cumulative mm" = "Bodega Bay",
                       "Blue Oak Ranch Rainfall Cumulative mm" = "Blue Oak",
                       "Hastings Rainfall Cumulative mm" = "Hastings Ranch")

# Plot
p <- ggplot(df_long, aes(x = Time, y = Temperature, color = Site)) +
  geom_line() +
  geom_hline(yintercept = 1000, linetype = "dashed", color = "black", linewidth = .5) +
  labs(title = "2022 Percipitation by Site",
       y = "Air Temperature (째C)",
       x = "Date",
       color = NULL) +
  theme_minimal(base_size = 14) +
  theme(legend.position = "right") +  
  scale_color_manual(
    values = c("Angelo Coast" = "#E69F00", "Bodega Bay" = "#009E73", "Blue Oak" = "#56B4E9", "Hastings Ranch" = "#D55E00")
  ) +
  scale_x_date(labels = date_format("%Y-%m"), date_breaks = "1 month") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

p


ggsave("2022-precipitation-by-site.jpg", plot = p, width = 10, height = 6, dpi = 1000)
```

2023 Percip
```{r}
# Read the CSV file
df <- read_csv("/Users/Helen/Desktop/2023-rainfall.csv")

# Convert from wide to long format
df_long <- df %>%
  pivot_longer(-Time, names_to = "Site", values_to = "Temperature")

# Convert Date column to Date format
df_long <- df_long %>%
  mutate(Time = as.Date(Time))


df_long$Site <- recode(df_long$Site,
                       "Angelo South Meadow Rainfall Cumulative mm" = "Angelo Coast",
                       "Bodega Rainfall Cumulative mm" = "Bodega Bay",
                       "Blue Oak Ranch Rainfall Cumulative mm" = "Blue Oak",
                       "Hastings Rainfall Cumulative mm" = "Hastings Ranch")

# Plot
p <- ggplot(df_long, aes(x = Time, y = Temperature, color = Site)) +
  geom_line() +
  geom_hline(yintercept = 1000, linetype = "dashed", color = "black", linewidth = .5) +
  labs(title = "2023 Percipitation by Site",
       y = "Air Temperature (째C)",
       x = "Date",
       color = NULL) +
  theme_minimal(base_size = 14) +
  theme(legend.position = "right") +  
  scale_color_manual(
    values = c("Angelo Coast" = "#E69F00", "Bodega Bay" = "#009E73", "Blue Oak" = "#56B4E9", "Hastings Ranch" = "#D55E00")
  ) +
  scale_x_date(labels = date_format("%Y-%m"), date_breaks = "1 month") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

p


ggsave("2023-precipitation-by-site.jpg", plot = p, width = 10, height = 6, dpi = 1000)
```

Map of CA
```{r}
# Load libraries
library(ggplot2)
library(rnaturalearth)
library(sf)
library(ggspatial)

# Define site data
locations <- data.frame(
  name = c("Angelo Coast (AC)", "Bodega Bay (BB)", "Blue Oak (BO)", "Hastings Ranch (HR)"),
  lat = c(39.71812, 38.31805, 37.3813, 36.37909),
  lon = c(-123.65304, -123.07173, -121.73674, -121.56288)
)

# Custom color palette
site_colors <- c(
  "Angelo Coast (AC)" = "#E69F00",
  "Bodega Bay (BB)" = "#009E73",
  "Blue Oak (BO)" = "#56B4E9",
  "Hastings Ranch (HR)" = "#D55E00"
)

# Convert to sf object
sites_sf <- st_as_sf(locations, coords = c("lon", "lat"), crs = 4326)

# Load California base map
us_states <- ne_states(country = "united states of america", returnclass = "sf")
california <- us_states[us_states$name == "California", ]

# Plot
p <- ggplot() +
  geom_sf(data = california, fill = "gray95", color = "black") +
  geom_sf(data = sites_sf, aes(color = name), size = 3, show.legend = FALSE) +
  geom_sf_text(data = sites_sf, aes(label = name), nudge_x = 0.17, size = 4, hjust = 0) +
  scale_color_manual(values = site_colors) +
  annotation_scale(location = "bl", width_hint = 0.25) +
  annotation_north_arrow(location = "tl", which_north = "true", 
                         style = north_arrow_fancy_orienteering) +
  coord_sf(xlim = c(-125.5, -119), ylim = c(35.5, 41)) +
  labs(title = "Site Locations in California", x = "Longitude", y = "Latitude") +
  theme_minimal(base_size = 14)

p

ggsave("site_locations.jpeg", plot = p, width = 10, height = 6, dpi = 700)

```

