This file describes the contents of 12 files loaded to the Dryad data depository on 5 May 2015 by Stuart Wagenius.

1.  inbreedingsPedigreeCrossLevel.csv
2.  inbreedingsHdInsectsDamage.csv
3.  inbreedingsFitnessInsectsDamageTo2013.csv
4.  InbreedingCoreData04_21_2014.csv
5.  inb1D.csv 
6.  echinacea.c1.inb1.aphids.csv
7.  R script aphidsOnEchinaceaInb1_2015-05-05.R
8.  R script inb1aphids-120614sw.R
9.  R script echinacea.inb1.herbivory.asterVisualize3.R
10. barf.RData
11. bars.RData
12. fred.RData

These files contain the data, analysis, and results associated with the paper "The susceptibility of Echinacea angustifolia to a specialist aphid: eco-evolutionary perspective on genotypic variation and demographic consequences" in press at Journal of Ecology. 

Files 1-5 are datasets related to field and lab measurements of 557 individual Echinacea angustifolia plants in the inb1 experiment in Douglas, County Minnesota, USA.

Analyses of these datasets were conducted using R version 3.2.0. The scripts of these analyses (files 7-9) produce output files 6, 10, 11, and 12, as well as the figures and tables in the paper. Files 6, 10, 11, and 12 also serve as input files read by other R scripts (files 8 & 9). Details and metadata about each file are  below.

Field data were collected by S. Wagenius, G. Kiefer, R. Shaw and other members of Team Echinacea. Volunteers and interns at the Chicago Botanic Garden contributed to cleaning heads and assessing seed set in achenes.

Associated datasets and further information about this experiment and other experiments in the same plot are available on the Echinacea Project website: http://echinaceaproject.org/experiments/inb1/

Contact Stuart Wagenius, Gretel Kiefer, or Ruth Shaw with questions about these datasets and analyses at echinaceaproject@gmail.com.

Stuart Wagenius 
stuart.wagenius@gmail.com
http://echinaceaproject.org/


#####################################################
#   Metadata & details about each of the 12 files   #
#####################################################

1. File inbreedingsPedigreeCrossLevel.csv contains pedigree information (inbreeding level, parent ids, sites of origin) of 557 Echinacea angustifolia plants in experiment inb1 in Douglas County, Minnesota, USA. 

Column headings and descriptions:

cgPlaId — common garden plant Id (numeric)
expNm — experiment name / name of experiment within cg1 (text)
matCgPlaId — maternal plant identifier; cgPlaId for Dam used in cross (integer)
matFam — maternal family; Id for grandDam in remnant EA pop (integer)
matPop — maternal population; remnant of origin for grandDam (text)
sireCgPlaId — sire plant identifier; cgPlaId for Sire used in cross (integer)
sireFam — sire family; Id for grandDam in remnant EA pop (integer)
sirePop — sire population; remnant of origin for grandDam (text)
crossLevel — cross level; 3 cross types: I = inbred, W = within remnant, B = between remnants (text)


2. File inbreedingsHdInsectsDamage.csv contains information about insects and damage to heads and stems on flowering Echinacea angustifolia plants in experiment inb1 in Douglas County, Minnesota, USA during 2004 - 2013. The aphid is Aphis echinaceae.

Column headings and descriptions:

cgHdId — common garden head Id (numeric)
cgPlaId — common garden plant Id (numeric)
hdMeasureYr — head measure year (numeric)
expNm — experiment name / name of experiment within cg1 (text) 
caulineLfCt — count of cauline leaves by flowering rosette (numeric)
longestCaulineLfByRosette — length of longest cauline leaf by flowering rosette (cm) (numeric)
hdInsects — insects present on head / list of insects separated by “;” generated by multiselection box on data entry form (text) **
**ant and aphid data from the field ‘hdInsects’ are displayed in binary format in the following 8 fields (1=observed, 0=not observed)
ant1 — 1 ant
ant2to10 — 2 to 10 ants
antGT10 — greater than 10 ants
aphid1 — 1 aphid
aphid2to10 — 2 to 10 aphids
aphid11to80 — 11 to 80 aphids
aphidGT80 — greater than 80 aphids
antNest — ant nest
hdInsectDamageTxt — list of damage observed on leaves (by flowering rosette) separated by “;” generated by multiselection box on data entry form (text) **damage data from the field 'hdInsectDamageTxt' are displayed in binary format in the following 4 fields (1=observed, 0=not observed) & tabulated in the last 3 fields.
nibbles — nibbles present / 1 or null, 1 = yes (numeric)
holes — holes present / 1 or null, 1 = yes (numeric)
wrinkles — wrinkles present / 1 or null, 1 = yes (numeric)
rolledLf — rolled leaf present / 1 or null, 1 = yes (numeric)
totalMinorInsDam — count of leaves with minor (less than 25% of leaf damaged) insect damage (numeric)
totalHalfGoneInsDam — count of leaves half-gone (25% to 50% of leaf damaged) due to insect damage (numeric)
totalGoneInsDam — count of leaves gone (greater than 50% of leaf damaged) due to insect damage (numeric)


3. File inbreedingsFitnessInsectsDamageTo2013.csv contains annual measurements, insect information, and damage data for 557 Echinacea angustifolia plants in experiment inb1 in Douglas County, Minnesota, USA during 2001- 2013.

Column headings and descriptions (Note these are very similar to column headings in  http://echinaceaproject.org/datasets/km-aphid-abundance-and-plant-damage-2004-2012/):

row — common garden location coordinate / easting or row coordinate in meters (numeric)
pos — common garden location coordinate / northing or position coordinate in meters (numeric)
cgPlaId — common garden plant Id (numeric)
expNm — experiment name / name of experiment within cg1 (text)
measureYr — measure year / year plant was observed (numeric)
measureDt — measure data / date plant was measured yyyy-mm-dd (date)
plaStatusDesc — plant status description (text)
basalRosetteCt — basal rosette count (numeric)
floweringRosetteCt — flowering rosette count (numeric)
basalLfCt — basal leaf count (numeric)
longestBasalLf — longest basal leaf (numeric)
longestCaulineLf — longest cauline leaf (numeric)
insects — insects present / list of insects separated by “;” generated by multiselection box on data entry form (text) **
**ant and aphid data from the field ‘insects’ are displayed in binary format in the following 8 fields (1=observed, 0=not observed)
ant1 — 1 ant
ant2to10 — 2 to 10 ants
antGT10 — greater than 10 ants
aphid1 — 1 aphid
aphid2to10 — 2 to 10 aphids
aphid11to80 — 11 to 80 aphids
aphidGT80 — greater than 80 aphids
antNest — ant nest
insectsNote — insects note (text) / description of observed insect not included in multiselection field ‘insects’
nibbles — nibbles present / 1 or null, 1 = yes (numeric)
holes — holes present / 1 or null, 1 = yes (numeric)
wrinkles — wrinkles present / 1 or null, 1 = yes (numeric)
rolledLf — rolled leaf present / 1 or null, 1 = yes (numeric)
totalMinorInsDam — count of leaves with minor (less than 25% of leaf damaged) insect damage (numeric)
totalHalfGoneInsDam — count of leaves half-gone (25% to 50% of leaf damaged) due to insect damage (numeric)
totalGoneInsDam — count of leaves gone (greater than 50% of leaf damaged) due to insect damage (numeric)
totalCrisp — count of crisp leaves (numeric)


4. File InbreedingCoreData04_21_2014.csv contains annual fitness components of plants 557 Echinacea angustifolia plants in experiment inb1 in Douglas County, Minnesota, USA during 2001- 2013.

Column headings and descriptions:

cgPlaId — common garden plant Id (numeric)
row — common garden location coordinate / easting or row coordinate in meters (numeric)
pos — common garden location coordinate / northing or position coordinate in meters (numeric)
yrPlanted — year planted (numeric)
The following 4 fields are in the format of the observed fitness measure followed by the year of observation (ex. ld2001). Measures are included for the years 2001-2013.
ld — living during a given year (1 = yes, 0 = no);
fl — flowering during a given year (1 = yes, 0 = no);
hdCt — count of heads, also known as capitula, for a given year (zero if a plant doesn’t flower during a given year);
achCt — sum of achenes produced by all heads on a plant during a given year (zero if a plant doesn’t flower during a given year).

*NOTE* here is an explanation for negative numbers in acheneCt: We use “-9999? as code for “missing data” in the achCt field for each head. If the plant had multiple heads & a count was missing for one of the heads, -9999 was summed together with the good achene count(s). So far, we don’t have any instances where more than one head has a missing achene count per plant; but if we do, I’ll make a note of it. So if hdCt > 1 & acheneCt < 0 adding 9999 to acheneCt will give you the acheneCt for the heads that are not missing data.


5. File inb1D.csv contains annualinformation about plants 557 Echinacea angustifolia plants in experiment inb1 in Douglas County, Minnesota, USA during 2001- 2008.

Column headings and descriptions:

Note that the fitness fields (ld, fl, hdct, achct) here overlap with the core data in file #4, (InbreedingCoreData04_21_2014.csv). File #4 is more up-to-date and complete.

cgplaid— common garden plant Id (numeric)
newplantid — new plant identifier (numeric)
lds1 — living during seedling stage 1 (numeric)
lds2 — living during seedling stage 2 (numeric)
lds3 — living during seedling stage 3 (numeric)
ld01 — living during first year (2001?) (numeric)
crosstype — 3 cross types: Wi = inbred, Wr = within remnant, Br = between remnants (text)
yearcross — year of crossing (numeric)
flat — planting flat number (numeric) 
site_patfam — sire population; remnant of origin for grandDam (text)
SitemaxFloweringPl — maximum number of flowering plants at sire remnant (numeric)
mass — mass of achene (mg)
row — common garden location coordinate / easting or row coordinate in meters (numeric)
posi — common garden location coordinate / northing or position coordinate caluclated from position (numeric)
The following 4 fields are in the format of the observed fitness measure followed by the year of observation (ex. ld.2002). 
ld — living during a given year (1 = yes, 0 = no);
fl — flowering during a given year (1 = yes, 0 = no);
hdct — count of heads, also known as capitula, for a given year (zero if a plant doesn’t flower during a given year);
achct — sum of achenes produced by all heads on a plant during a given year (zero if a plant doesn’t flower during a given year).
*NOTE* here is an explanation for negative numbers in acheneCt: We use “-9999? as code for “missing data” in the achCt field for each head. If the plant had multiple heads & a count was missing for one of the heads, -9999 was summed together with the good achene count(s). So far, we don’t have any instances where more than one head has a missing achene count per plant. So if hdct > 1 & achct < 0 adding 9999 to achct will give you the achct for the heads that are not missing data.


6. File echinacea.c1.inb1.aphids.csv contains a single record of annual aphid abundance for each of 557 Echinacea angustifolia plants in experiment inb1 in Douglas County, Minnesota, USA during each year 2004 - 2013. This file is calculated in script #7 (aphidsOnEchinaceaInb1_2015-05-05.R) and output as a csv file. This file is read as an input file in script #8 (inb1aphids-120614sw.R).

Column headings and descriptions:

cgPlaId	- common garden plant Id (integer)
year - year of annual calculated abundance (integer)
aph.bf1 - aphid infestation level per plant per year. This is an ordered factor with five levels. The "0" indicates either dead plants or missing data, while "bf0" indicates no aphids observed.


7. R script aphidsOnEchinaceaInb1_2015-05-05.R reads the data files on plant and head aphid abundance (#1, 2, 3), calculates aphid-load per plant, outputs file #6, conducts the polr and glm analyses, then outpurs two pdf files for figures and one txt file that is a table S1. Note: In the process of running this script several temporary files are written and then re-read: fig-a.RData and 3 csv files prefixed "tempXXX." Bad form, I know, but it works.

Input files: inbreedingsFitnessInsectsDamageTo2013.csv, inbreedingsHdInsectsDamage.csv, inbreedingsPedigreeCrossLevel.csv

Output: file echinacea.c1.inb1.aphids.csv, pdf files of figure 2 and figure S1, and tableA.txt.


8. R script inb1aphids-120614sw.R reads the core fitness data and the pedigree data  (files #4 & 5) and conducts the aster fitness analysis. It reads the annual aphid-load dataset (file # 6) and then conducts the aster analyses with aphid loads. Then it outputs files #10, 11 & 12 for making figures.

Input: inb1D.csv, InbreedingCoreData04_21_2014.csv, echinacea.c1.inb1.aphids.csv

Output: barf.RData, bars.RData, fred.RData


9. R script echinacea.inb1.herbivory.asterVisualize3.R reads files #10, 11 & 12 and uses the values therein to make pdf files that become figures 3  & 4.

Input:  barf.RData, bars.RData, fred.RData

Output: two pdf files for figures 3 & 4.


10. File barf.RData is a temporary file output from script #8 (inb1aphids-120614sw.R) containing a dataframe of estimated model parameters that is read by script #9 (echinacea.inb1.herbivory.asterVisualize3.R) and used to make Figure 4. 


11. File bars.RData is a temporary file output from script #8 (inb1aphids-120614sw.R) containing a dataframe with standard errors of estimated model parameters that is read by script #9 (echinacea.inb1.herbivory.asterVisualize3.R) and used to make Figure 4.


12. File fred.RData is a temporary file output from script #8 (inb1aphids-120614sw.R) containing a dataframe of estimated model parameters with standard errors that is read by script #9 (echinacea.inb1.herbivory.asterVisualize3.R) and used to make Figure 3.

